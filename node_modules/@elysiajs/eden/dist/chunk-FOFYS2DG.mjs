import{a as W,b as x,c as K}from"./chunk-HUZ6GXDC.mjs";var R=typeof FileList>"u",$=n=>R?n instanceof Blob:n instanceof FileList||n instanceof File,J=n=>{if(!n)return!1;for(let e in n){if($(n[e]))return!0;if(Array.isArray(n[e])&&n[e].find(t=>$(t)))return!0}return!1},T=n=>R?n:new Promise(e=>{let t=new FileReader;t.onload=()=>{let s=new File([t.result],n.name,{lastModified:n.lastModified,type:n.type});e(s)},t.readAsArrayBuffer(n)}),F=class{ws;url;constructor(e){this.ws=new WebSocket(e),this.url=e}send(e){return Array.isArray(e)?(e.forEach(t=>this.send(t)),this):(this.ws.send(typeof e=="object"?JSON.stringify(e):e.toString()),this)}on(e,t,s){return this.addEventListener(e,t,s)}off(e,t,s){return this.ws.removeEventListener(e,t,s),this}subscribe(e,t){return this.addEventListener("message",e,t)}addEventListener(e,t,s){return this.ws.addEventListener(e,l=>{if(e==="message"){let r=l.data.toString(),u=r.charCodeAt(0);if(u===47||u===123)try{r=JSON.parse(r)}catch{}else x(r)?r=+r:r==="true"?r=!0:r==="false"&&(r=!1);t({...l,data:r})}else t(l)},s),this}removeEventListener(e,t,s){return this.off(e,t,s),this}close(){return this.ws.close(),this}},M=(n,e="",t)=>new Proxy(()=>{},{get(s,l,r){return M(n,`${e}/${l.toString()}`,t)},apply(s,l,[r,u={}]=[{},{}]){let y=r!==void 0&&(typeof r!="object"||Array.isArray(r))?r:void 0,{$query:I,$fetch:O,$headers:j,$transform:E,getRaw:C,...P}=r??{};y??=P;let b=e.lastIndexOf("/"),g=e.slice(b+1).toUpperCase(),S=W(n,b===-1?"/":e.slice(0,b),Object.assign(u.query??{},I)),q=t.fetcher??fetch,p=t.transform?Array.isArray(t.transform)?t.transform:[t.transform]:void 0,v=E?Array.isArray(E)?E:[E]:void 0;return v&&(p?p=v.concat(p):p=v),g==="SUBSCRIBE"?new F(S.replace(/^([^]+):\/\//,S.startsWith("https://")?"wss://":"ws://")):(async N=>{let a,L={...t.$fetch?.headers,...O?.headers,...u.headers,...j};if(g!=="GET"&&g!=="HEAD"){a=Object.keys(y).length||Array.isArray(y)?y:void 0;let i=a&&(typeof a=="object"||Array.isArray(y));if(i&&J(a)){let h=new FormData;for(let[m,f]of Object.entries(a))if(R)h.append(m,f);else if(f instanceof File)h.append(m,await T(f));else if(f instanceof FileList)for(let d=0;d<f.length;d++)h.append(m,await T(f[d]));else if(Array.isArray(f))for(let d=0;d<f.length;d++){let k=f[d];h.append(m,k instanceof File?await T(k):k)}else h.append(m,f);a=h}else a!=null&&(L["content-type"]=i?"application/json":"text/plain",a=i?JSON.stringify(a):y)}let o=await q(S,{method:g,body:a,...t.$fetch,...u.fetch,...O,headers:L}),w;if(N.getRaw)return o;switch(o.headers.get("Content-Type")?.split(";")[0]){case"application/json":w=await o.json();break;default:w=await o.text().then(i=>x(i)?+i:i==="true"?!0:i==="false"?!1:i)}let D=o.status>=300||o.status<200?new K(o.status,w):null,A={data:w,error:D,response:o,status:o.status,headers:o.headers};if(p)for(let i of p){let c=i(A);c instanceof Promise&&(c=await c),c!=null&&(A=c)}return A})({getRaw:C})}}),G=(n,e={fetcher:fetch})=>new Proxy({},{get(t,s){return M(n,s,e)}});export{F as a,G as b};
